#!/usr/bin/env python3
# adapted from https://wiki.archlinux.org/index.php/spotify#Show_track_notifications
# Add `ui.track_notifications_enabled=false` to .config/spotify/Users/<user-id>/prefs to avoid dup notifs

import subprocess
from gi.repository import Playerctl, GLib

player = Playerctl.Player()

def on_track_change(player, e):
    track_info = '{title} - {artist}\n<i>{album}</i>'.format(
        title=player.get_title(),
        artist=player.get_artist(),
        album=player.get_album()
    )
    subprocess.Popen(['notify-send', '--urgency', 'low', track_info])

player.on('metadata', on_track_change)

GLib.MainLoop().run()
